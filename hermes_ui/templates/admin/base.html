{% import 'admin/layout.html' as layout with context -%}
{% import 'admin/static.html' as admin_static with context %}
<!DOCTYPE html>
<html>
<head>
    <title>{% block title %}{% if admin_view.category %}{{ admin_view.category }} - {% endif %}{{ admin_view.name }} -
        {{ admin_view.admin.name }}{% endblock title %}</title>

    {% block head_meta %}
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    {% endblock head_meta %}

    {% block head_css %}
        <!-- Bootstrap 3.3.6 -->
        <link href="{{ url_for('static',filename='css/bootstrap.min.css') }}" rel="stylesheet"/>
        <!-- Font Awesome -->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"/>
        <!-- Ionicons -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css"/>
        <!-- Theme style -->
        <link href="{{ url_for('static',filename='css/AdminLTE.min.css') }}" rel="stylesheet"/>
        <!-- AdminLTE Skins. Choose a skin from the css/skins folder instead of downloading all of them to reduce the load. -->
        <link href="{{ url_for('static',filename='css/skins/_all-skins.min.css') }}" rel="stylesheet"/>
        <!-- iCheck -->
        <link href="{{ url_for('static',filename='plugins/iCheck/flat/blue.css') }}" rel="stylesheet"/>
        <!-- Morris chart -->
        <link href="{{ url_for('static',filename='plugins/morris/morris.css') }}" rel="stylesheet"/>
        <!-- jvectormap -->
        <link href="{{ url_for('static',filename='plugins/jvectormap/jquery-jvectormap-1.2.2.css') }}"
              rel="stylesheet"/>

        <link href="https://cdnjs.cloudflare.com/ajax/libs/jquery.terminal/2.8.0/css/jquery.terminal.min.css" rel="stylesheet"/>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.2.1/themes/default/style.min.css" rel="stylesheet"/>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/jsoneditor/5.32.5/jsoneditor.min.css" rel="stylesheet"/>

        <link href="https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.4/awesomplete.min.css" rel="stylesheet"/>

        <link href="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.5.1/min/dropzone.min.css" rel="stylesheet"/>

        <link href="https://cdn.datatables.net/1.10.19/css/dataTables.bootstrap.min.css" rel="stylesheet"/>

        <link href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.9.3/introjs.min.css" rel="stylesheet"/>
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/styles/default.min.css">

        <link href="{{ url_for('static', filename='css/jstree/proton/style.min.css') }}" rel="stylesheet"/>

        <!-- Date Picker -->
        <link href="{{ url_for('static',filename='plugins/datepicker/datepicker3.css') }}" rel="stylesheet"/>
        <!-- Daterange picker -->
        <link href="{{ url_for('static',filename='plugins/daterangepicker/daterangepicker.css') }}" rel="stylesheet"/>
        <!-- bootstrap wysihtml5 - text editor -->
        <link href="{{ url_for('static',filename='plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.min.css') }}"
              rel="stylesheet"/>
        <!-- Flask-admin admin styles -->
        <link href="{{ admin_static.url(filename='admin/css/bootstrap3/admin.css', v='1.1.1') }}" rel="stylesheet">
        {% if admin_view.extra_css %}
            {% for css_url in admin_view.extra_css %}
                <link href="{{ css_url }}" rel="stylesheet">
            {% endfor %}
        {% endif %}

        <style>
            pre {
                text-align: left;
            }

            .awesomplete {
                width: 100%;
            }

            .swal2-actions {
                z-index: 0 !important;
            }

            .swal2-container:not(.swal2-top):not(.swal2-top-start):not(.swal2-top-end):not(.swal2-top-left):not(.swal2-top-right):not(.swal2-center-start):not(.swal2-center-end):not(.swal2-center-left):not(.swal2-center-right):not(.swal2-bottom):not(.swal2-bottom-start):not(.swal2-bottom-end):not(.swal2-bottom-left):not(.swal2-bottom-right):not(.swal2-grow-fullscreen) > .swal2-modal {
                width: auto !important;
                min-width: 400px !important;
            }

            .onoffswitch {
                position: relative;
                width: 90px;
                -webkit-user-select: none;
                -moz-user-select: none;
                -ms-user-select: none;
            }

            .onoffswitch-checkbox {
                display: none;
            }

            .onoffswitch-label {
                display: block;
                overflow: hidden;
                cursor: pointer;
                border: 2px solid #999999;
                border-radius: 20px;
            }

            .onoffswitch-inner {
                display: block;
                width: 200%;
                margin-left: -100%;
                transition: margin 0.3s ease-in 0s;
            }

            .onoffswitch-inner:before, .onoffswitch-inner:after {
                display: block;
                float: left;
                width: 50%;
                height: 30px;
                padding: 0;
                line-height: 30px;
                font-size: 14px;
                color: white;
                font-family: Trebuchet, Arial, sans-serif;
                font-weight: bold;
                box-sizing: border-box;
            }

            .onoffswitch-inner:before {
                content: "PROD";
                padding-left: 10px;
                background-color: #34A7C1;
                color: #FFFFFF;
            }

            .onoffswitch-inner:after {
                content: "TEST";
                padding-right: 10px;
                background-color: #EEEEEE;
                color: #999999;
                text-align: right;
            }

            .onoffswitch-switch {
                display: block;
                width: 18px;
                margin: 6px;
                background: #FFFFFF;
                position: absolute;
                top: 0;
                bottom: 0;
                right: 56px;
                border: 2px solid #999999;
                border-radius: 20px;
                transition: all 0.3s ease-in 0s;
            }

            .onoffswitch-checkbox:checked + .onoffswitch-label .onoffswitch-inner {
                margin-left: 0;
            }

            .onoffswitch-checkbox:checked + .onoffswitch-label .onoffswitch-switch {
                right: 0px;
            }

            .sidebarh.right {
                top: 0;
                right: 0;
                bottom: 0;
                width: 300px;
                background: #448AFF;
                z-index: 9999;
                overflow-y: scroll !important;
            }

            .sidebarh {
                box-shadow: 0 0 5px rgba(0, 0, 0, 0.64);
                position: fixed;
                color: white;
                padding: 30px;
                font-size: 2em;
                text-align: center;
            }

            .btn-float {
                position: fixed;
                width: 60px;
                height: 60px;
                bottom: 40px;
                right: 40px;
                background-color: #0C9;
                color: #FFF;
                border-radius: 50px;
                text-align: center;
                box-shadow: 2px 2px 3px #999;
                z-index: 99999;
            }

            .btn-my-float {
                margin-top: 22px;
            }

            #session-variables-globales, #session-variables-locales, #session-filtre {
                font-size: 9pt;
            }

            .chatbox {
                position: fixed;
                bottom: 0;
                right: 150px;
                width: 300px;
                height: 400px;
                background-color: #fff;
                font-family: 'Lato', sans-serif;

                -webkit-transition: all 600ms cubic-bezier(0.19, 1, 0.22, 1);
                transition: all 600ms cubic-bezier(0.19, 1, 0.22, 1);

                display: -webkit-flex;
                display: flex;

                -webkit-flex-direction: column;
                flex-direction: column;
            }

            .chatbox--tray {
                bottom: -350px;
            }

            .chatbox--closed {
                bottom: -400px;
            }

            .chatbox .form-control:focus {
                border-color: #1f2836;
            }

            .chatbox__title,
            .chatbox__body {
                border-bottom: none;
            }

            .chatbox__title {
                min-height: 50px;
                padding-right: 10px;
                background-color: #1f2836;
                border-top-left-radius: 4px;
                border-top-right-radius: 4px;
                cursor: pointer;

                display: -webkit-flex;
                display: flex;

                -webkit-align-items: center;
                align-items: center;
            }

            .chatbox__title h5 {
                height: 50px;
                margin: 0 0 0 15px;
                line-height: 50px;
                position: relative;
                padding-left: 20px;

                -webkit-flex-grow: 1;
                flex-grow: 1;
            }

            .chatbox__title h5 a {
                color: #fff;
                max-width: 195px;
                display: inline-block;
                text-decoration: none;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            }

            .chatbox__title h5:before {
                content: '';
                display: block;
                position: absolute;
                top: 50%;
                left: 0;
                width: 12px;
                height: 12px;
                background: #4CAF50;
                border-radius: 6px;

                -webkit-transform: translateY(-50%);
                transform: translateY(-50%);
            }

            .chatbox__title__tray,
            .chatbox__title__close {
                width: 24px;
                height: 24px;
                outline: 0;
                border: none;
                background-color: transparent;
                opacity: 0.5;
                cursor: pointer;

                -webkit-transition: opacity 200ms;
                transition: opacity 200ms;
            }

            .chatbox__title__tray:hover,
            .chatbox__title__close:hover {
                opacity: 1;
            }

            .chatbox__title__tray span {
                width: 12px;
                height: 12px;
                display: inline-block;
                border-bottom: 2px solid #fff
            }

            .chatbox__title__close svg {
                vertical-align: middle;
                stroke-linecap: round;
                stroke-linejoin: round;
                stroke-width: 1.2px;
            }

            .chatbox__body,
            .chatbox__credentials {
                padding: 15px;
                border-top: 0;
                background-color: #f5f5f5;
                border-left: 1px solid #ddd;
                border-right: 1px solid #ddd;

                -webkit-flex-grow: 1;
                flex-grow: 1;
            }

            .chatbox__credentials {
                display: none;
            }

            .chatbox__credentials .form-control {
                -webkit-box-shadow: none;
                box-shadow: none;
            }

            .chatbox__body {
                overflow-y: auto;
            }

            .chatbox__body__message {
                position: relative;
            }

            .chatbox__body__message p {
                padding: 15px;
                border-radius: 4px;
                font-size: 14px;
                background-color: #fff;
                -webkit-box-shadow: 1px 1px rgba(100, 100, 100, 0.1);
                box-shadow: 1px 1px rgba(100, 100, 100, 0.1);
            }

            .chatbox__body__message img {
                width: 40px;
                height: 40px;
                border-radius: 4px;
                border: 2px solid #fcfcfc;
                position: absolute;
                top: 15px;
            }

            .chatbox__body__message--left p {
                margin-left: 15px;
                padding-left: 30px;
                text-align: left;
            }

            .chatbox__body__message--left img {
                left: -5px;
            }

            .chatbox__body__message--right p {
                margin-right: 15px;
                padding-right: 30px;
                text-align: right;
            }

            .chatbox__body__message--right img {
                right: -5px;
            }

            .chatbox__message {
                padding: 15px;
                min-height: 50px;
                outline: 0;
                resize: none;
                border: none;
                font-size: 12px;
                border: 1px solid #ddd;
                border-bottom: none;
                background-color: #fefefe;
            }

            .chatbox--empty {
                height: 262px;
                z-index: 5;
            }

            .chatbox--empty.chatbox--tray {
                bottom: -212px;
            }

            .chatbox--empty.chatbox--closed {
                bottom: -262px;
            }

            .chatbox--empty .chatbox__body,
            .chatbox--empty .chatbox__message {
                display: none;
            }

            .chatbox--empty .chatbox__credentials {
                display: block;
            }

            #detecteur-fichier-dropzone-floatbox {
                border: dashed 5px lightseagreen;
            }

        </style>
    {% endblock head_css %}

    {% block head %}
    {% endblock head %}

    {% block head_tail %}
    {% endblock head_tail %}

</head>
<body class="hold-transition skin-{{ admin_view.admin.skin }} sidebar-mini">

{% block page_body %}

<div class="wrapper">

    <div class="sidebarh right">

        <h4>Variables locales</h4>

        <div class="box box-widget widget-user-2">
            <div class="box-footer no-padding">
                <ul id="session-variables-locales" class="nav nav-stacked">
                    <li><b>Aucune</b></li>
                </ul>
            </div>
        </div>

        <h4>Variables globales</h4>

        <div class="box box-widget widget-user-2">
            <div class="box-footer no-padding">
                <ul id="session-variables-globales" class="nav nav-stacked">
                    <li><b>Aucune</b></li>
                </ul>
            </div>
        </div>

        <h4>Filtres sur variable</h4>

        <div class="box box-widget widget-user-2">
            <div class="box-footer no-padding">
                <ul id="session-filtre" class="nav nav-stacked">
                    <li><b>Aucune</b></li>
                </ul>
            </div>
        </div>

    </div>

    <a onclick="$('.sidebarh.right').trigger('sidebar:toggle');" class="btn-float">
        <i class="fa fa-external-link-square btn-my-float"></i>
    </a>

    <div data-step="4" data-intro="Cette zone va vous permettre de tester la résolution de vos détecteurs en fonction d'une source brute ou d'un fichier message" class="chatbox chatbox--tray chatbox--empty">
        <div class="chatbox__title">
            <h5>
                <a href="#">Simulation de détecteur</a>
            </h5>
            <button class="chatbox__title__tray">
                <span></span>
            </button>
        </div>

        <div class="row">
            <div class="col-lg-6">
                <a style="height: 80px !important;" onclick="AppInterfaceInteroperabilite.assistant_simulation_extraction_interet()" class="btn btn-app">
                    <i class="fa fa-microchip"></i> Analyse Manuelle<br>Brute
                </a>
            </div>
            <div class="col-lg-6">
                <a style="height: 80px !important;" onclick="AppInterfaceInteroperabilite.assistant_simulation_detecteur()" class="btn btn-app">
                    <i class="fa fa-flag"></i> Analyse Manuelle<br>Detecteur
                </a>
            </div>
        </div>

        <form id="detecteur-fichier-dropzone-floatbox" action="/admin/rest/simulation/detecteur/fichier" class="chatbox__credentials dropzone" style="border-style: dashed;">
            <div class="fallback">
                <input name="file" type="file" />
            </div>
        </form>

    </div>

    {% if current_user.is_authenticated %}

    <header class="main-header">
        {% block brand %}
        <a href="{{ admin_view.admin.url }}" class="logo">
            <!-- mini logo for sidebar mini 50x50 pixels -->
            <span class="logo-mini">
                            {% autoescape false %}{{ admin_view.admin.short_name }}{% endautoescape %}
                        </span>
            <!-- logo for regular state and mobile devices -->
            <span class="logo-lg">
                            {% autoescape false %}{{ admin_view.admin.long_name }}{% endautoescape %}
                        </span>
        </a>
        {% endblock brand %}

        <nav class="navbar navbar-static-top">
            <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
                <span class="sr-only"></span>
            </a>
            <div class="navbar-custom-menu">
                <ul class="nav navbar-nav">

                    <li>
                        {% block access_control %}
                            {% if current_user.is_authenticated %}
                                <li class="dropdown user user-menu">
                                    <a href="#" class="dropdown-toggle" data-toggle="dropdown"
                                       style="padding: 10px 15px;">
                                        <img src="{{ admin_view.admin.gravatar_image_url(current_user.email, "http://adminlte.najdaapps.com/static/img/avatar.png", 30) }}"
                                             style="border-radius: 50%; width: 30px; height:30px;"/>
                                        <span class="hidden-xs"></span>
                                    </a>
                                    <ul class="dropdown-menu">
                                        <li class="user-header">
                                            <img src="{{ admin_view.admin.gravatar_image_url(current_user.email, "http://adminlte.najdaapps.com/static/img/avatar.png", 90) }}"
                                                 style="border-radius: 50%"/>
                                            <p>
                                                {% if current_user.first_name %}
                                                    {{ current_user.first_name }}
                                                    {% if current_user.last_name %}
                                                        {{ current_user.last_name }}
                                                    {% endif %}
                                                    <small>{{ current_user.email }}</small>
                                                {% else %}
                                                    {{ current_user.email }}
                                                {% endif %}
                                            </p>
                                        </li>
                                        <li class="user-footer">
                                            {% if security.changeable %}
                                                <div class="pull-left">
                                                    <a href="{{ url_for('security.change_password') }}"
                                                       class="btn btn-default btn-flat">
                                                        Modifier mot de passe
                                                    </a>
                                                </div>
                                            {% endif %}
                                            <div class="pull-right">
                                                <a href="{{ url_for('security.logout') }}"
                                                   class="btn btn-default btn-flat">Déconnexion</a>
                                            </div>
                                        </li>
                                    </ul>
                                </li>
                            {% endif %}
                        {% endblock %}
                    </li>
                </ul>
                {% block menu_links %}
                    <ul class="nav navbar-nav navbar-right">
                        {{ layout.menu_links() }}
                    </ul>
                {% endblock %}
            </div>
        </nav>
    </header>

    <aside class="main-sidebar">
        <section class="sidebar">
            <ul
                    data-step="13"
                    data-intro="
                    Concevoir son <b>Automate</b> c'est d'abord commencer par
                    concevoir un <b>Détecteur</b> !<br><br>
                    <ul>
                    <li>Créez des règles depuis <b>Règles de détection</b></li>
                    <li>Créez un <b>Détecteur</b> et associez y vos règles fraichements éditées</li>
                    <li>Créez une <b>Description d'Automate</b> et associez y votre nouveau détecteur</li>
                    <li>Editez les <b>Actions</b> de votre <b>Automate</b> depuis cette page</li>
                    </ul>"
                    class="sidebar-menu">
                <li class="header">NAVIGATION</li>
                {% block main_menu %}
                    {{ layout.menu() }}
                {% endblock %}
            </ul>
        </section>
    </aside>

    <div class="content-wrapper">
        {% endif %}

        {% block messages %}
            <section style="padding: 1px;">
                {{ layout.messages() }}
            </section>
        {% endblock messages %}

        {# store the jinja2 context for form_rules rendering logic #}
        {% set render_ctx = h.resolve_ctx() %}

        {% block body %}
        {% endblock body %}

        {% if current_user.is_authenticated %}
            </div>
            <footer class="main-footer">
                <strong>Projet invalidé</strong> Fin de vie programmé Août 2019
                <div class="pull-right hidden-xs"><b>Version</b> 1.5.0</div>
            </footer>
        {% endif %}

</div>

{% endblock page_body %}

{% block tail_js %}

    <!-- jQuery 2.2.3 -->
    <script src="{{ url_for('static',filename='plugins/jQuery/jquery-2.2.3.min.js') }}"></script>
    <!-- jQuery UI 1.11.4 -->
    <script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
    <!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
    <script>
        $.widget.bridge('uibutton', $.ui.button);
    </script>
    <!-- Bootstrap 3.3.6 -->
    <script src="{{ url_for('static',filename='js/bootstrap.min.js') }}"></script>
    <script src="{{ admin_static.url(filename='vendor/select2/select2.min.js', v='3.5.2') }}"
            type="text/javascript"></script>

    {% if admin_view.extra_js %}
        {% for js_url in admin_view.extra_js %}
            <script src="{{ js_url }}" type="text/javascript"></script>
        {% endfor %}
    {% endif %}

    <!-- Morris.js charts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
    <script src="{{ url_for('static',filename='plugins/morris/morris.min.js') }}"></script>
    <!-- Sparkline -->
    <script src="{{ url_for('static',filename='plugins/sparkline/jquery.sparkline.min.js') }}"></script>
    <!-- jvectormap -->
    <script src="{{ url_for('static',filename='plugins/jvectormap/jquery-jvectormap-1.2.2.min.js') }}"></script>
    <script src="{{ url_for('static',filename='plugins/jvectormap/jquery-jvectormap-world-mill-en.js') }}"></script>
    <!-- jQuery Knob Chart -->
    <script src="{{ url_for('static',filename='plugins/knob/jquery.knob.js') }}"></script>
    <!-- daterangepicker -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.11.2/moment.min.js"></script>
    <script src="{{ url_for('static',filename='plugins/daterangepicker/daterangepicker.js') }}"></script>
    <!-- datepicker -->
    <script src="{{ url_for('static',filename='plugins/datepicker/bootstrap-datepicker.js') }}"></script>
    <!-- Bootstrap WYSIHTML5 -->
    <script src="{{ url_for('static',filename='plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.all.min.js') }}"></script>
    <!-- Slimscroll -->
    <script src="{{ url_for('static',filename='plugins/slimScroll/jquery.slimscroll.min.js') }}"></script>
    <!-- FastClick -->
    <script src="{{ url_for('static',filename='plugins/fastclick/fastclick.js') }}"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.terminal/2.8.0/js/jquery.terminal.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jstree/3.2.1/jstree.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@8.11.4"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsoneditor/5.32.5/jsoneditor.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/awesomplete/1.1.4/awesomplete.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/dropzone/5.5.1/min/dropzone.min.js"></script>

    <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/2.9.3/intro.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-sidebar/3.3.2/jquery.sidebar.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js"></script>

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.8/highlight.min.js"></script>

    <script src="{{ url_for('static',filename='js/a-tools.js') }}"></script>
    <script src="{{ url_for('static',filename='js/jquery.asuggest.js') }}"></script>
    <script src="{{ url_for('static',filename='js/jquery.livequery.js') }}"></script>

    <!-- AdminLTE App -->
    <script src="{{ url_for('static',filename='js/app.min.js') }}"></script>
    <!-- AdminLTE for demo purposes -->
    <script src="{{ url_for('static',filename='js/lib.js') }}"></script>

    <script src="{{ url_for('static',filename='js/helpers.js') }}"></script>

    {% if admin_view.name=="Interopérabilité" %}
        <!--<script src="{{ url_for('static',filename='js/pages/dashboard.js') }}"></script>-->
        <script src="{{ url_for('static',filename='js/app_interoperabilite.js') }}"></script>
    {% endif %}

{% endblock tail_js %}

{% block tail %}
{% endblock tail %}

</body>
</html>
